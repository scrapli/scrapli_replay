
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tools to enable easy testing of scrapli programs">
      
      
        <meta name="author" content="Carl Montanari">
      
      
        <link rel="canonical" href="https://scrapli.github.io/user_guide/basic_usage/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Basic Usage - Scrapli Replay</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="teal">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#basic-usage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Scrapli Replay" class="md-header__button md-logo" aria-label="Scrapli Replay" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Scrapli Replay
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Basic Usage
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/scrapli/scrapli_replay" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    scrapli/scrapli_replay
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Scrapli Replay" class="md-nav__button md-logo" aria-label="Scrapli Replay" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Scrapli Replay
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/scrapli/scrapli_replay" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    scrapli/scrapli_replay
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Scrapli Replay
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        Quick Start Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../project_details/" class="md-nav__link">
        Project Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../versioning/" class="md-nav__link">
        Versioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Basic Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Basic Usage
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-do-you-need-to-get-done" class="md-nav__link">
    What do you need to get done!?!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytest-plugin" class="md-nav__link">
    Pytest Plugin
  </a>
  
    <nav class="md-nav" aria-label="Pytest Plugin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview-and-use-case" class="md-nav__link">
    Overview and Use Case
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    How it Works
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-it" class="md-nav__link">
    How to Use it
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytest-plugin-options" class="md-nav__link">
    Pytest Plugin Options
  </a>
  
    <nav class="md-nav" aria-label="Pytest Plugin Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mode" class="md-nav__link">
    Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory" class="md-nav__link">
    Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overwrite" class="md-nav__link">
    Overwrite
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable" class="md-nav__link">
    Disable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-network" class="md-nav__link">
    Block Network
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collector-and-server" class="md-nav__link">
    Collector and Server
  </a>
  
    <nav class="md-nav" aria-label="Collector and Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collector" class="md-nav__link">
    Collector
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server" class="md-nav__link">
    Server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          More Scrapli
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="More Scrapli" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          More Scrapli
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../more_scrapli/scrapli/" class="md-nav__link">
        Scrapli
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../more_scrapli/scrapli_netconf/" class="md-nav__link">
        Scrapli Netconf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../more_scrapli/scrapli_community/" class="md-nav__link">
        Scrapli Community
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../more_scrapli/scrapli_cfg/" class="md-nav__link">
        Scrapli Cfg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../more_scrapli/nornir_scrapli/" class="md-nav__link">
        Nornir Scrapli
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Other
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/code_of_conduct/" class="md-nav__link">
        Code of Conduct
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-do-you-need-to-get-done" class="md-nav__link">
    What do you need to get done!?!
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytest-plugin" class="md-nav__link">
    Pytest Plugin
  </a>
  
    <nav class="md-nav" aria-label="Pytest Plugin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview-and-use-case" class="md-nav__link">
    Overview and Use Case
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-it-works" class="md-nav__link">
    How it Works
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-use-it" class="md-nav__link">
    How to Use it
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytest-plugin-options" class="md-nav__link">
    Pytest Plugin Options
  </a>
  
    <nav class="md-nav" aria-label="Pytest Plugin Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mode" class="md-nav__link">
    Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#directory" class="md-nav__link">
    Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overwrite" class="md-nav__link">
    Overwrite
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable" class="md-nav__link">
    Disable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#block-network" class="md-nav__link">
    Block Network
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collector-and-server" class="md-nav__link">
    Collector and Server
  </a>
  
    <nav class="md-nav" aria-label="Collector and Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collector" class="md-nav__link">
    Collector
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server" class="md-nav__link">
    Server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="basic-usage">Basic Usage<a class="headerlink" href="#basic-usage" title="Permanent link">&para;</a></h1>
<h2 id="what-do-you-need-to-get-done">What do you need to get done!?!<a class="headerlink" href="#what-do-you-need-to-get-done" title="Permanent link">&para;</a></h2>
<p>First things first: what do you need to get done? scrapli replay contains two similar yet very different testing 
tools. </p>
<p>The first, is the pytest plugin -- a plugin to mark tests with. This plugin will record scrapli session 
inputs and outputs and save them, that way you can store these test sessions and re-use them (without needing a 
"live" device) in your CI setup.</p>
<p>The second, is a "collector", and a "server" that allow you to build semi-interactive SSH servers that you can 
connect to for testing purposes. This allows you to have "mock"/"fake"/"dummy" SSH server(s) that look and feel like 
"real" network devices -- as with the pytest plugin, this could be useful in CI, or it could just be handy for 
offline testing.</p>
<p>As you'd expect, if you are writing tests and wanting to have some reasonable assurances that your code that 
interacts with scrapli is doing what you think it should be doing, then you probably want to use the pytest plugin! 
If you just want to have a mock SSH server to play with, then the collector/server may be interesting to you.</p>
<h2 id="pytest-plugin">Pytest Plugin<a class="headerlink" href="#pytest-plugin" title="Permanent link">&para;</a></h2>
<h3 id="overview-and-use-case">Overview and Use Case<a class="headerlink" href="#overview-and-use-case" title="Permanent link">&para;</a></h3>
<p>As shown in the quickstart guide, getting going with the pytest plugin is fairly straightforward -- tests that 
contain scrapli operations can be marked with the <code>scrapli_replay</code> marker, causing scrapli replay to automatically 
wrap this test and record or replay sessions within the test.</p>
<p>In order for scrapli replay to do this, there is one big caveat: the scrapli connection <em>must be opened within the 
test</em>! Projects like <code>pytest-vcr</code> don't have this requirement because the sessions are stateless HTTP(s) sessions -- 
this is of course not the case for Telnet/SSH where we have more or less a stateful connection object. This may 
sound like a limiting factor for scrapli replay and perhaps it is, however it is relatively easy to work with as 
you'll see below!</p>
<p>Here is a very simple example of a class that creates a scrapli connection and has some methods to do stuff:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">scrapli</span> <span class="kn">import</span> <span class="n">Scrapli</span>


<span class="k">class</span> <span class="nc">Example</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span> <span class="o">=</span> <span class="n">Scrapli</span><span class="p">(</span>
            <span class="n">host</span><span class="o">=</span><span class="s2">&quot;c3560&quot;</span><span class="p">,</span> <span class="n">platform</span><span class="o">=</span><span class="s2">&quot;cisco_iosxe&quot;</span><span class="p">,</span> <span class="n">ssh_config_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">auth_strict_key</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="c1"># dont do this! dont have side affects in init, but helps demonstrate things!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">do_stuff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the version from the device&quot;&quot;&quot;</span>
        <span class="n">version_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">send_command</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="s2">&quot;show version | i Software&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">version_result</span><span class="o">.</span><span class="n">failed</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;__FAILURE__&quot;</span>

        <span class="n">version_result_string</span> <span class="o">=</span> <span class="n">version_result</span><span class="o">.</span><span class="n">result</span>
        <span class="n">version_result_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span>
            <span class="n">pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Version ([a-z0-9\.\(\)]*)&quot;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="n">version_result_string</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">I</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">version_result_match</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;__FAILURE__&quot;</span>

        <span class="k">return</span> <span class="n">version_result_match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<p>Let's pretend we want to write some tests for the <code>do_stuff</code> method of this example class. We probably want to have 
at least three test cases for this method:</p>
<ol>
<li>Testing a failed result from the initial show command</li>
<li>Testing a success event where we properly get and parse the version string</li>
<li>Testing a failed parsing of the version string</li>
</ol>
<p>For cases one and three we probably don't want or need scrapli replay -- we could simply patch the <code>send_command</code> 
method of scrapli, returning bad data -- either a bad scrapli <code>Response</code> object, or a <code>Response</code> object with data 
that will cause our regex to fail.</p>
<p>For case number 2, however, we <em>could</em> also patch scrapli and return correct data, this would validate that our 
function, when given appropriate outputs from scrapli, does what it should do. This would be a valuable test. With 
scrapli replay, however, we can take this a bit further! We can now create a test case that records <em>actual device 
inputs and outputs</em> and saves that data in a scrapli replay session. Subsequent tests can then <em>replay</em> that input 
and output data. Rather than just testing that our regex works w/ some patched response data we can now very simply 
test not only that, but also scrapli -- ensuring that scrapli is behaving as you would expect!</p>
<h3 id="how-it-works">How it Works<a class="headerlink" href="#how-it-works" title="Permanent link">&para;</a></h3>
<p>Before jumping into how to use scrapli replay, it's worth spending a bit of time to understand how it works. At a 
high level, scrapli replay is a Pytest plugin that you can "mark" tests with. By marking a test you are effectively 
"wrapping" that test in the scrapli replay <code>ScrapliReplay</code> class.</p>
<p>The pytest plugin then uses the <code>ScrapliReplay</code> class as a context manager, yielding to your test within the context 
manager. For tests that are marked <code>asyncio</code> we simply use the async context manager capability instead of the 
synchronous version. This selection of sync vs async happens transparently to you --  you just need to mark your 
tests with the <code>asyncio</code> marker if they are asyncio (which you had to do anyway, so no biggie!).</p>
<p>While the <code>ScrapliReplay</code> context manager is active (while your test is running) <code>ScrapliReplay</code> patches the <code>open</code> 
method of scrapli and a <code>ConnectionProfile</code> is recorded (host/user/is using password/auth 
bypass/etc.). This <code>ConnectionProfile</code> is stored as part of the scrapli replay session data -- allowing us to 
validate that during subsequent test runs the connection information has not changed (if it has we raise an 
exception to fail the test).</p>
<p>After the <code>ConnectionProfile</code> is recorded, the scrapli <code>Channel</code> (or <code>AsyncChannel</code>) read and write methods are 
patched (replaced) with scrapli replay read/write methods. If the current test iteration is in "record" mode, we 
patch with the "record" read/write, otherwise we patch with the "replay" read/write -- these methods do what they 
sound like! Recording or replaying session data.</p>
<p>At completion of your test, when the context manager is closing the session will be dumped to a yaml file in your 
session output directory (by default this is a folder located with your test file).</p>
<p>Due to the fact that scrapli replay uses the open method of scrapli in order to fetch connection data and also to 
patch the channel objects, there is a requirement that the test actually opens the connection. This sounds perhaps 
limiting, and probably it is somewhat, however you can fairly easily work around this by having a fixture that 
returns an object with the connection already opened -- this fixture currently must be scoped to the <em>function</em> 
level. This will hopefully be improved in further scrapli replay releases to allow us to cache session-wide fixtures.</p>
<h3 id="how-to-use-it">How to Use it<a class="headerlink" href="#how-to-use-it" title="Permanent link">&para;</a></h3>
<p>As shown in the quickstart, using scrapli replay is fairly straightforward -- simply mark a test with the correct 
marker. The complication generally will come from needing to have the connection opened within that test being 
wrapped -- this section will showcase some basic ways to use scrapli replay, as well as how we can handle the 
connection opening problem.</p>
<p>Working with the example class from the overview section, let's handle test case number 2. To start, we can do this 
with the patching method -- without scrapli replay:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">scrapli.response</span> <span class="kn">import</span> <span class="n">Response</span>


<span class="k">def</span> <span class="nf">test_example_do_stuff_patching</span><span class="p">(</span><span class="n">monkeypatch</span><span class="p">,</span> <span class="n">example_instance</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test Example.do_stuff&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">patched_send_command</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">command</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="n">channel_input</span><span class="o">=</span><span class="n">command</span><span class="p">)</span>
        <span class="n">r</span><span class="o">.</span><span class="n">record_response</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Software Version 15.2(4)E7&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">r</span>

    <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="s2">&quot;scrapli.driver.network.sync_driver.NetworkDriver.send_command&quot;</span><span class="p">,</span> <span class="n">patched_send_command</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">example_instance</span><span class="o">.</span><span class="n">do_stuff</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;15.2(4)E7&quot;</span>
</code></pre></div></td></tr></table></div>
<p>This works reasonably well, and properly tests our regex does indeed find the version string; of course you could 
actually return a real device output instead of the abbreviated output here as well -- that would make things a bit 
more "real". This is nice, but it does not test any scrapli behavior at all as scrapli is completely patched out of 
the test. There must be a better way!</p>
<p>Let's now re-write this test using scrapli replay:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">example</span> <span class="kn">import</span> <span class="n">Example</span>  <span class="c1"># &lt;- this is assuming directory structure as in the &quot;examples/simple_test_case&quot; example!</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">scrapli_replay</span>
<span class="k">def</span> <span class="nf">test_example_do_stuff_no_fixture</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Test Example.do_stuff&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">Example</span><span class="p">()</span><span class="o">.</span><span class="n">do_stuff</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;15.2(4)E7&quot;</span>
</code></pre></div></td></tr></table></div>
<p>No patching?! Amazing! So... what is going on here?</p>
<p>The <code>Example</code> class (from the snippet way above here) is created, which causes the scrapli connection to open, then 
we call the <code>do_stuff</code> method which fetches the version and parses it with some regex. Scrapli replay is "aware" of 
this test due to the marker -- this basically means that this test is living inside of a scrapli replay context 
manager... you can think of it as something like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">with</span> <span class="n">ScrapliReplay</span><span class="p">:</span>
    <span class="n">test</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>An oversimplified example, but not by much!</p>
<p>If you run this example (from the examples dir in the repo) the first time the test is ran, scrapli will actually 
connect to your device and record the output. This of course means that you need proper credentials/access in order 
to get this first recording done -- using ssh keys/config file so that you don't need to store any user/creds in 
your test is a great way to deal with this.</p>
<p>At the end of the test, scrapli replay will dump the "session" data out to a yaml file in a new folder called 
"scrapli_replay_sessions" that was created in the same directory of your test file (you can change this, see the 
options section!). This "session" file looks like this:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">connection_profile</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c3560</span><span class="w"></span>
<span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">22</span><span class="w"></span>
<span class="w">  </span><span class="nt">auth_username</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="w"></span>
<span class="w">  </span><span class="nt">auth_password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="nt">auth_private_key</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="w"></span>
<span class="w">  </span><span class="nt">auth_private_key_passphrase</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="nt">auth_bypass</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="nt">transport</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">system</span><span class="w"></span>
<span class="w">  </span><span class="nt">auth_secondary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="nt">interactions</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel_output</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Warning:</span><span class="nv"> </span><span class="s">Permanently</span><span class="nv"> </span><span class="s">added</span><span class="nv"> </span><span class="s">&#39;c3560,172.31.254.1&#39;</span><span class="nv"> </span><span class="s">(RSA)</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">the\</span>
<span class="w">      </span><span class="s">\ list</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">known</span><span class="nv"> </span><span class="s">hosts.\n\nC3560CX#&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input_redacted</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel_output</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;\nC3560CX#&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terminal length 0</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input_redacted</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel_output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terminal length 0</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input_redacted</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel_output</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;\nC3560CX#&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terminal width 512</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input_redacted</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel_output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">terminal width 512</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input_redacted</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel_output</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;\nC3560CX#&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">show version | i Software</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input_redacted</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel_output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">show version | i Software</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input_redacted</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">channel_output</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;\nCisco</span><span class="nv"> </span><span class="s">IOS</span><span class="nv"> </span><span class="s">Software,</span><span class="nv"> </span><span class="s">C3560CX</span><span class="nv"> </span><span class="s">Software</span><span class="nv"> </span><span class="s">(C3560CX-UNIVERSALK9-M),\</span>
<span class="w">      </span><span class="s">\ Version</span><span class="nv"> </span><span class="s">15.2(4)E7,</span><span class="nv"> </span><span class="s">RELEASE</span><span class="nv"> </span><span class="s">SOFTWARE</span><span class="nv"> </span><span class="s">(fc2)\nC3560CX#&quot;</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">expected_channel_input_redacted</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"></span>
</code></pre></div></td></tr></table></div>
<p>As you can see, connection details are stored (but never credentials) -- in the event of password authentication the 
password is not stored and is marked as "REDACTED" in the interactions output.</p>
<p>Running the test again you'll notice that its even faster than scrapli normally is! Why? Because there is no actual 
connection going out to the device, the connection will just be automatically replayed from this session data!</p>
<p>Now if you have a billion tests to write, or you are needing to pass lots of inputs in order to create your scrapli 
connection objects in every single test... that wouldn't be very fun! In cases like this it would be a great idea to 
put either the scrapli connection object, or the device containing the connection object into a fixture and allowing 
pytest to pass that fixture into each test function. Here is a simple example of a fixture for our example setup:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">example</span> <span class="kn">import</span> <span class="n">Example</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;function&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">example_instance</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Simple fixture to return Example instance&quot;&quot;&quot;</span>
    <span class="k">yield</span> <span class="n">Example</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>And... a test taking advantage of this fixture:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">scrapli_replay</span>
<span class="k">def</span> <span class="nf">test_example_do_stuff_with_fixture</span><span class="p">(</span><span class="n">example_instance</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test Example.do_stuff&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">example_instance</span><span class="o">.</span><span class="n">do_stuff</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;15.2(4)E7&quot;</span>
</code></pre></div></td></tr></table></div>
<p>It is important to note that the fixture scope <em>must be</em> set to <code>function</code> -- again, this is because scrapli replay 
<em>requires</em> the connection to be opened within the test it is wrapping in order to properly record the connection 
profile and patch the read/write methods!</p>
<h3 id="pytest-plugin-options">Pytest Plugin Options<a class="headerlink" href="#pytest-plugin-options" title="Permanent link">&para;</a></h3>
<p>scrapli replay supports a handful of arguments to modify its behavior, currently, these are configurable via the 
pytest cli -- in the future they will likely be configurable by a dedicated fixture as well.</p>
<p>The available options are:</p>
<h4 id="mode">Mode<a class="headerlink" href="#mode" title="Permanent link">&para;</a></h4>
<p>The "replay" mode setting manages how scrapli replay handles replaying or recording sessions. This setting has the 
following options:</p>
<ul>
<li>replay: the default mode; if no session exists scrapli replay will record/create one, otherwise it will "replay" 
  existing sessions (meaning you dont need to connect to a device)</li>
<li>record: <em>probably</em> not needed often, does at it says -- records things. If a session exists it will auto switch to 
  replay mode (meaning <em>not</em> overwrite the session)</li>
<li>overwrite: overwrite existing all sessions always</li>
</ul>
<p>This option is configurable with the <code>--scrapli-replay-mode</code> switch:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python -m pytest tests --scrapli-replay-mode overwrite
</code></pre></div></td></tr></table></div>
<h4 id="directory">Directory<a class="headerlink" href="#directory" title="Permanent link">&para;</a></h4>
<p>By default, scrapli replay stores the recorded sessions in a directory in the same folder as the test that is being 
executed. This is modifiable with the <code>--scrapli-replay-directory</code> switch:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python -m pytest tests --scrapli-replay-directory /my/cool/session/dir
</code></pre></div></td></tr></table></div>
<h4 id="overwrite">Overwrite<a class="headerlink" href="#overwrite" title="Permanent link">&para;</a></h4>
<p>If you need to overwrite only certain test session data, you can do so by using the <code>--scrapli-replay-overwrite</code> 
switch. This argument accepts a comma separated list of test names of which to overwrite the session data.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python -m pytest tests --scrapli-replay-overwrite test1,test2,test3
</code></pre></div></td></tr></table></div>
<h4 id="disable">Disable<a class="headerlink" href="#disable" title="Permanent link">&para;</a></h4>
<p>You can disable entirely the scrapli replay functionality -- meaning your tests will run "normally" without 
any of the scrapli replay patching/session work happening. This is done with the <code>--scrapli-replay-disable</code> flag.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python -m pytest tests --scrapli-replay-disable
</code></pre></div></td></tr></table></div>
<h4 id="block-network">Block Network<a class="headerlink" href="#block-network" title="Permanent link">&para;</a></h4>
<p>Finally, you can "block" network connections -- this will cause any connection with a valid recorded session to be 
"replay"'d as normal, but any tests that would require recording a session will be skipped. The 
<code>--scrapli-replay-block-network</code> flag controls this.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python -m pytest tests --scrapli-replay-block-network
</code></pre></div></td></tr></table></div>
<h2 id="collector-and-server">Collector and Server<a class="headerlink" href="#collector-and-server" title="Permanent link">&para;</a></h2>
<h3 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h3>
<p>The scrapli replay "collector" and "server" functionality is useful for creating mock ssh servers that are 
"semi-interactive". You can provide any number of commands (not configs! more on this in a bit) that you would like 
to collect from a device, and the collector will run the provided commands at all privilege levels, and with and 
without "on_open" functionality being executed (generally this means with and without paging being disabled). The 
collector will also collect any on open commands, on close commands, all privilege escalation/deescalation commands, 
and "unknown" or invalid command output from every privilege level. </p>
<p>Just like the pytest plugin, the scrapli replay collector will output the collected data to a yaml file. This yaml 
file is then consumed by the scrapli replay server. The server itself is an asyncssh server that does its best to 
look and feel just like the real device that you collected the data from.</p>
<h3 id="collector">Collector<a class="headerlink" href="#collector" title="Permanent link">&para;</a></h3>
<p>As outlined in the overview section, the collector.... collects things! The collector tries to collect as much info 
from the device as is practical, with the ultimate goal of being able to allow the server to look pretty close to a 
real device.</p>
<p>Before continuing, it is important to note that currently the collector can only be used with <em>network devices</em> -- 
meaning it <em>must</em> be used with a scrapli platform that extends the <code>NetworkDriver</code> class; moreover it <em>must</em> be used 
with a <em>synchronous</em> transport. There will likely <em>not</em> be any asyncio support for the collector (it doesn't seem to 
be very valuable to add asyncio support...  please open an issue if you disagree!).</p>
<p>To get started with the collector is fairly straight forward, simply create a collector class, passing in the 
commands you wish to collect, some details about "paging" (more on this in a sec), and the kwargs necessary to create 
the scrapli connection to collect from:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">scrapli_replay.server.collector</span> <span class="kn">import</span> <span class="n">ScrapliCollector</span>

<span class="n">scrapli_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
    <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">24022</span><span class="p">,</span>
    <span class="s2">&quot;ssh_config_file&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;auth_strict_key&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;auth_username&quot;</span><span class="p">:</span> <span class="s2">&quot;vrnetlab&quot;</span><span class="p">,</span>
    <span class="s2">&quot;auth_password&quot;</span><span class="p">:</span> <span class="s2">&quot;VR-netlab9&quot;</span><span class="p">,</span>
    <span class="s2">&quot;auth_secondary&quot;</span><span class="p">:</span> <span class="s2">&quot;VR-netlab9&quot;</span><span class="p">,</span>
    <span class="s2">&quot;platform&quot;</span><span class="p">:</span> <span class="s2">&quot;arista_eos&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">collector</span> <span class="o">=</span> <span class="n">ScrapliCollector</span><span class="p">(</span>
    <span class="n">channel_inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;show version&quot;</span><span class="p">,</span> <span class="s2">&quot;show run&quot;</span><span class="p">],</span>
    <span class="n">interact_events</span><span class="o">=</span><span class="p">[</span>
        <span class="p">[(</span><span class="s2">&quot;clear logg&quot;</span><span class="p">,</span> <span class="s2">&quot;Clear logging buffer [confirm]&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;switch#&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)]</span>
    <span class="p">],</span>
    <span class="n">paging_indicator</span><span class="o">=</span><span class="s2">&quot;--More--&quot;</span><span class="p">,</span>
    <span class="n">paging_escape_string</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">scrapli_kwargs</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>If you are familiar with scrapli connections, the above snippet should look fairly similar! In addition to the 
scrapli connection data we see a few extra things:</p>
<ul>
<li><code>channel_inputs</code> -- a list of "inputs" you wish to send to the device for recording. Each of these inputs will be 
  run at every privilege level of the device, and before and after executing the "on_open" function (if applicable)</li>
<li><code>interact_events</code> -- similar to "normal" scrapli, a list of lists of tuples of "interact events" to record at each 
  privilege level (and before/after on_open)</li>
<li><code>paging_indicator</code> -- this is what it sounds like -- a string that lets us know if the device has paginated output 
  data</li>
<li><code>paging_escape_string</code> -- a string to send to "cancel" a command output if paging is encountered -- typically an 
  escape, or a <code>q</code> works for most devices</li>
</ul>
<p><em>Note</em> -- you can also pass an existing scrapli connection to the <code>scrapli_connection</code> argument if you prefer 
(instead of the kwargs needed to create a connection)!</p>
<p>Once a collector object has been created, you can open the connection and simply run the <code>collect</code> method, followed 
by the <code>dump</code> method:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">collector</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="n">collector</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="n">collector</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">collector</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>The session data will be dumped to a yaml file called "scrapli_replay_collector_session.yaml" (configurable with the 
<code>collector_session_filename</code> argument) in your current directory. Once you have a session stored, you can run the 
"server" to create a semi-interactive ssh server!</p>
<p><em>Note</em> -- unless you have real dns server(s) setup, and you can resolve things, you should disable domain-lookup -- 
if you don't the timeouts may (will!?) get exceeded and it will cause collection to fail in confusing ways.</p>
<h3 id="server">Server<a class="headerlink" href="#server" title="Permanent link">&para;</a></h3>
<p>Starting the scrapli replay server is simple!</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">from</span> <span class="nn">scrapli_replay.server.server</span> <span class="kn">import</span> <span class="n">start</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">start</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">2001</span><span class="p">,</span> <span class="n">collect_data</span><span class="o">=</span><span class="s2">&quot;scrapli_replay_collector_session.yaml&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">run_forever</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>You can pass whatever port you wish for the <code>port</code> argument, and the <code>collect_data</code> must be the collected 
data from the collector.</p>
<p>Once the server is running you should be able to SSH to the server on the provided port just as if it were a "real" 
device! The username and password will always be "scrapli" regardless of what the credentials were for the collected 
server -- this is done so we never have to deal with or think about storing credentials.</p>
<p>There are several big caveats to be aware of!</p>
<ul>
<li>Credentials: username/password (including for "enable" password) will always be "scrapli", as mentioned this is to 
  keep things simple and not deal with storing any credential data</li>
<li>Configs: configuration things are not supported and probably won't ever be. It would be a lot of work to keep 
  track of when/if a user sends a config and what the resulting configuration would look like.</li>
</ul>
<p>The remaining major caveats are all around the "paging" behavior of the mock server(s). Before diving into these 
caveats, it is worth knowing a little bit about how scrapli behaves in general. Typical scrapli connections are 
opened, and an "on_open" function is executed -- this function normally disables pagination on a device, this is done so 
scrapli never has to deal with prompts like "--More--" during the output of a command. The collector/server stores 
the commands that are executed in the "on_open" function, and <em>assumes</em> that these commands disable pagination for 
the given device (this is true for all core platforms, so it <em>must</em> be true, right? :)). With that out of the way:</p>
<ul>
<li>Disabling pagination requires <em>all</em> "on_open" commands to be executed: if the "on_open" command for your platform 
  contains "terminal length 0" and "terminal width 512", <em>both</em> commands must be seen before the server will disable 
  pagination. If you send just "terminal length 0" (even though this disables pagination on IOSXE/etc.) but have 
  <em>not</em> also sent "terminal width 512" the server will show you paginated output!</li>
<li>Re-enabling pagination/logging in/out: You cannot <em>re-enable</em> pagination on the server, the only way to do this is 
  to exit/re-connect. This is because the collector has no way to know what commands are actually doing/what 
  commands disable/re-enable pagination (and we would never re-enable pagination in scrapli anyway!).</li>
</ul>
<p>With all the caveats out of the way, let's check out a mock server:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code>$ ssh localhost -p 2001 -l scrapli
Warning: Permanently added &#39;[localhost]:2222&#39; (RSA) to the list of known hosts.
Password:
C3560CX#show version
Cisco IOS Software, C3560CX Software (C3560CX-UNIVERSALK9-M), Version 15.2(4)E7, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2018 by Cisco Systems, Inc.
Compiled Tue 18-Sep-18 13:20 by prod_rel_team

ROM: Bootstrap program is C3560CX boot loader
BOOTLDR: C3560CX Boot Loader (C3560CX-HBOOT-M) Version 15.2(4r)E5, RELEASE SOFTWARE (fc4)

C3560CX uptime is 1 week, 3 days, 2 hours, 55 minutes
System returned to ROM by power-on
System restarted at 07:13:48 PST Thu Jan 14 2021
System image file is &quot;flash:c3560cx-universalk9-mz.152-4.E7.bin&quot;
Last reload reason: power-on



This product contains cryptographic features and is subject to United
States and local country laws governing import, export, transfer and
use. Delivery of Cisco cryptographic products does not imply
third-party authority to import, export, distribute or use encryption.
Importers, exporters, distributors and users are responsible for
 --More--
C3560CX#
</code></pre></div></td></tr></table></div>
<p>In the above output we connect to the mock server (with username/password of "scrapli") and execute the "show 
version" command -- as paging has <em>not</em> been disabled we get the lovely "--More--" pagination indicator. Simply 
sending another return here gets us back to our prompt.</p>
<p>Continuing on... let's try to disable paging:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code>&lt;&lt; SNIP &gt;&gt;
This product contains cryptographic features and is subject to United
States and local country laws governing import, export, transfer and
use. Delivery of Cisco cryptographic products does not imply
third-party authority to import, export, distribute or use encryption.
Importers, exporters, distributors and users are responsible for
 --More--
C3560CX#terminal length 0
C3560CX#terminal width 511
% Unknown command or computer name, or unable to find computer address
C3560CX#terminal width 512
C3560CX#
</code></pre></div></td></tr></table></div>
<p>Whoops - you can see that sending "terminal width 511" (instead of the "correct" command from the "on_open" 
function "terminal width 512") caused the server to send us an "Unknown command" output -- similar to if you sent an 
bad command on a "real" switch.</p>
<p>Now that we have paging disabled, we can try the "show version" command again:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code>&lt;&lt; SNIP &gt;&gt;
This product contains cryptographic features and is subject to United
States and local country laws governing import, export, transfer and
use. Delivery of Cisco cryptographic products does not imply
third-party authority to import, export, distribute or use encryption.
Importers, exporters, distributors and users are responsible for
 --More--
C3560CX#terminal length 0
C3560CX#terminal width 511
% Unknown command or computer name, or unable to find computer address
C3560CX#terminal width 512
C3560CX#show version
Cisco IOS Software, C3560CX Software (C3560CX-UNIVERSALK9-M), Version 15.2(4)E7, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2018 by Cisco Systems, Inc.
Compiled Tue 18-Sep-18 13:20 by prod_rel_team

ROM: Bootstrap program is C3560CX boot loader
BOOTLDR: C3560CX Boot Loader (C3560CX-HBOOT-M) Version 15.2(4r)E5, RELEASE SOFTWARE (fc4)

C3560CX uptime is 1 week, 3 days, 2 hours, 55 minutes
System returned to ROM by power-on
System restarted at 07:13:48 PST Thu Jan 14 2021
System image file is &quot;flash:c3560cx-universalk9-mz.152-4.E7.bin&quot;
Last reload reason: power-on



This product contains cryptographic features and is subject to United
States and local country laws governing import, export, transfer and
use. Delivery of Cisco cryptographic products does not imply
third-party authority to import, export, distribute or use encryption.
Importers, exporters, distributors and users are responsible for
compliance with U.S. and local country laws. By using this product you
agree to comply with applicable laws and regulations. If you are unable
to comply with U.S. and local laws, return this product immediately.

A summary of U.S. laws governing Cisco cryptographic products may be found at:
http://www.cisco.com/wwl/export/crypto/tool/stqrg.html

If you require further assistance please contact us by sending email to
export@cisco.com.

License Level: ipservices
License Type: Permanent Right-To-Use
Next reload license Level: ipservices

cisco WS-C3560CX-8PC-S (APM86XXX) processor (revision A0) with 524288K bytes of memory.
Processor board ID FOC1911Y0NH
Last reset from power-on
3 Virtual Ethernet interfaces
12 Gigabit Ethernet interfaces
The password-recovery mechanism is enabled.

512K bytes of flash-simulated non-volatile configuration memory.
Base ethernet MAC Address       : C8:00:84:B2:E9:80
Motherboard assembly number     : 73-16471-04
Power supply part number        : 341-0675-01
Motherboard serial number       : FOC190608U7
Power supply serial number      : DCB190430Z0
Model revision number           : A0
Motherboard revision number     : A0
Model number                    : WS-C3560CX-8PC-S
System serial number            : FOC1911Y0NH
Top Assembly Part Number        : 68-5359-01
Top Assembly Revision Number    : A0
Version ID                      : V01
CLEI Code Number                : CMM1400DRA
Hardware Board Revision Number  : 0x02


Switch Ports Model                     SW Version            SW Image
------ ----- -----                     ----------            ----------
*    1 12    WS-C3560CX-8PC-S          15.2(4)E7             C3560CX-UNIVERSALK9-M


Configuration register is 0xF

C3560CX#
</code></pre></div></td></tr></table></div>
<p>That looks about right! How about config mode?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code>C3560CX#configure terminal
Enter configuration commands, one per line.  End with CNTL/Z.
C3560CX(config)#show version
                  ^
% Invalid input detected at &#39;^&#39; marker.

C3560CX(config)#
</code></pre></div></td></tr></table></div>
<p>Sending a "show" command in config mode fails like you'd expect too. This is because we "collected" all the 
requested inputs at every privilege level. We can't send configs really because we didn't collect any and 
collector/server is not built to deal with configs anyway.</p>
<p>Ok, back down to exec?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code>C3560CX(config)#show version
                  ^
% Invalid input detected at &#39;^&#39; marker.

C3560CX(config)#end
C3560CX#disable
C3560CX&gt;enable
Password:
C3560CX#
</code></pre></div></td></tr></table></div>
<p>Down to exec no problem, and back up to privilege exec -- remember that the password is "scrapli"!</p>
<p>Thats about it for scrapli replay server -- the hope is that this can be useful for folks to do a bit of offline 
testing of basic scrapli (or whatever else really) scripts!</p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../installation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Installation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Installation
            </div>
          </div>
        </a>
      
      
        
        <a href="../../changelog/" class="md-footer__link md-footer__link--next" aria-label="Next: Changelog" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Changelog
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/carlmontanari/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/carlrmontanari" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.linkedin.com/in/carl-montanari-47888931/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://montanari.io" target="_blank" rel="noopener" title="montanari.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.3c-2.1-20.4-4.2-41.8-4.2-64 0-22.2 2.1-43.6 4.2-64h185.4c2.1 20.4 3.3 41.8 3.3 64zm151.9-64c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42.9 3.2-64 0-22-1.1-43.4-3.2-64h123.1zm-10.5-32H376.7c-10-63.86-29.8-117.38-55.3-151.558C399.8 29.09 463.4 85.94 493.4 160zm-149.1 0H167.7c6.1-36.4 15.5-68.62 27-94.65 10.5-23.61 22.2-40.74 33.5-51.54C239.4 3.178 248.7 0 256 0c7.3 0 16.6 3.178 27.8 13.81 11.3 10.8 23 27.93 33.5 51.54 11.5 26.03 20.9 58.25 27 94.65zm-325.69 0C48.59 85.94 112.2 29.09 190.6 8.442 165.1 42.62 145.3 96.14 135.3 160H18.61zm112.59 32c-2.1 20.6-4.1 42-4.1 64 0 21.1 2 43.4 4.1 64H8.065C2.8 299.5 0 278.1 0 256s2.8-43.5 8.065-64H131.2zm63.5 254.6c-11.5-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.7-22.2 40.8-33.5 51.6-11.2 10.6-20.5 13.8-28.7 13.8-6.4 0-15.7-3.2-26.9-13.8-11.3-10.8-23-27.9-33.5-51.6zm-4.1 57C112.2 482.9 48.59 426.1 18.61 352H135.3c10 63.9 29.8 117.4 55.3 151.6zm130.8 0c25.5-34.2 45.3-87.7 55.3-151.6h116.7c-30 74.1-93.6 130.9-172 151.6z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>